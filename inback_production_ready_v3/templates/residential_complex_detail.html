{% extends "base.html" %}

{% block title %}{{ complex.name }} - –ñ–ö –≤ –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä–µ —Å –∫—ç—à–±–µ–∫–æ–º{% endblock %}

{% block extra_head %}
<style>
    .gallery-dot.active {
        background-color: white !important;
    }
    
    .gallery-slides {
        transition: transform 0.5s ease-in-out;
    }
    
    #complex-map {
        min-height: 400px;
        border-radius: 12px;
    }
</style>
{% endblock %}

{% block content %}
<!-- Breadcrumbs -->
<div class="container mx-auto px-4 py-3 text-sm">
    <nav aria-label="Breadcrumb" class="flex">
        <ol class="inline-flex items-center space-x-1 md:space-x-3">
            <li class="inline-flex items-center">
                <a class="text-[#0088CC] hover:underline inline-flex items-center" href="/">
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path>
                    </svg>
                    –ì–ª–∞–≤–Ω–∞—è
                </a>
            </li>
            <li>
                <div class="flex items-center">
                    <svg class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    <a href="{{ url_for('residential_complexes') }}" class="text-[#0088CC] hover:underline ml-1 md:ml-2">–ñ–ö</a>
                </div>
            </li>
            <li aria-current="page">
                <div class="flex items-center">
                    <svg class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    <span class="text-gray-500 ml-1 md:ml-2">{{ complex.name }}</span>
                </div>
            </li>
        </ol>
    </nav>
</div>

<div class="max-w-6xl mx-auto px-4 py-8">
    <!-- –ö—ç—à–±–µ–∫ –±–∞–Ω–Ω–µ—Ä -->
    <div class="bg-gradient-to-r from-[#006699] to-[#0088CC] rounded-2xl p-6 text-white mb-8">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
            <div class="mb-4 md:mb-0">
                <h2 class="text-2xl font-bold mb-2">–ü–æ–ª—É—á–∏—Ç–µ –∫—ç—à–±–µ–∫ –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ –≤ —ç—Ç–æ–º –ñ–ö!</h2>
                <p class="opacity-90">–ü—Ä–∏–æ–±—Ä–µ—Ç–∞—è –∫–≤–∞—Ä—Ç–∏—Ä—É –≤ {{ complex.name }} —á–µ—Ä–µ–∑ –Ω–∞—à —Å–µ—Ä–≤–∏—Å, –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –∫—ç—à–±–µ–∫ –¥–æ {{ complex.cashback_percent }}% –æ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∫–≤–∞—Ä—Ç–∏—Ä—ã.</p>
            </div>
            <button onclick="openApplicationModal()" class="bg-white text-[#0088CC] hover:bg-opacity-90 font-semibold px-6 py-3 rounded-xl whitespace-nowrap transition-all">
                –ü–æ–ª—É—á–∏—Ç—å –∫—ç—à–±–µ–∫
            </button>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ -->
    <div class="bg-white rounded-2xl overflow-hidden shadow-lg mb-8">
        <!-- –ì–∞–ª–µ—Ä–µ—è -->
        <div class="relative">
            <div class="h-64 md:h-96 bg-gray-200 overflow-hidden gallery-container">
                <div class="gallery-slides flex h-full transition-transform duration-500">
                    <div class="gallery-slide min-w-full h-full">
                        <img alt="{{ complex.name }}" class="w-full h-full object-cover" src="{{ complex.image }}"/>
                    </div>
                    <div class="gallery-slide min-w-full h-full">
                        <img alt="{{ complex.name }} - –≤–∏–¥ 2" class="w-full h-full object-cover" src="{{ complex.image.replace('photo-1545324418', 'photo-1560448204-e02f11c3d0e2') }}" onerror="this.src='{{ complex.image }}'"/>
                    </div>
                    <div class="gallery-slide min-w-full h-full">
                        <img alt="{{ complex.name }} - –≤–∏–¥ 3" class="w-full h-full object-cover" src="{{ complex.image.replace('photo-1545324418', 'photo-1484154218962') }}" onerror="this.src='{{ complex.image }}'"/>
                    </div>
                </div>
                
                <!-- Navigation buttons -->
                <button onclick="prevGallerySlide()" class="absolute left-4 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-white/80 backdrop-blur-sm rounded-full flex items-center justify-center text-gray-600 hover:bg-white transition-all z-10">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button onclick="nextGallerySlide()" class="absolute right-4 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-white/80 backdrop-blur-sm rounded-full flex items-center justify-center text-gray-600 hover:bg-white transition-all z-10">
                    <i class="fas fa-chevron-right"></i>
                </button>
                
                <!-- Dots indicator -->
                <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2 z-10">
                    <div class="gallery-dot w-2 h-2 bg-white/60 rounded-full cursor-pointer hover:bg-white transition-colors active" onclick="goToGallerySlide(0)"></div>
                    <div class="gallery-dot w-2 h-2 bg-white/60 rounded-full cursor-pointer hover:bg-white transition-colors" onclick="goToGallerySlide(1)"></div>
                    <div class="gallery-dot w-2 h-2 bg-white/60 rounded-full cursor-pointer hover:bg-white transition-colors" onclick="goToGallerySlide(2)"></div>
                </div>
            </div>
            
            <div class="absolute bottom-4 left-4 bg-white/90 backdrop-blur px-3 py-1 rounded-full text-sm font-medium flex items-center">
                <i class="fas fa-camera mr-2 text-[#0088CC]"></i>
                <span>3 —Ñ–æ—Ç–æ</span>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="p-6">
            <div class="flex flex-col md:flex-row md:justify-between md:items-start gap-6">
                <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
                <div class="flex-1">
                    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –º–µ—Ç–∫–∏ -->
                    <div class="mb-4">
                        <h1 class="text-2xl md:text-3xl font-bold mb-2">{{ complex.name }}</h1>
                        <div class="flex flex-wrap gap-2 mb-4">
                            <span class="bg-gray-100 text-[#0088CC] px-3 py-1 rounded-full text-sm">–ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∞</span>
                            <span class="bg-gray-100 text-[#7e5bef] px-3 py-1 rounded-full text-sm">–ö–ª–∞—Å—Å {{ complex.building_class or "–∫–æ–º—Ñ–æ—Ä—Ç" }}</span>
                            <span class="bg-gray-100 text-green-700 px-3 py-1 rounded-full text-sm">–°–¥–∞—á–∞ {{ complex.completion_date }}</span>
                        </div>
                    </div>

                    <!-- –ê–¥—Ä–µ—Å -->
                    <div class="mb-6">
                        <div class="flex items-center text-gray-600 mb-1">
                            <i class="fas fa-map-marker-alt mr-2 text-[#0088CC]"></i>
                            <span>{{ complex.full_address or (complex.district + ", " + complex.location) }}</span>
                        </div>
                        <p class="text-sm text-gray-500">–†—è–¥–æ–º —Å –ñ–ö: {{ complex.nearby or "—Ç–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã, –ø–∞—Ä–∫–∏, —à–∫–æ–ª—ã" }}</p>
                    </div>

                    <!-- –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ -->
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
                        <div>
                            <p class="text-gray-500 text-sm">–°—Ä–æ–∫ —Å–¥–∞—á–∏</p>
                            <p class="font-semibold">{{ complex.completion_date }}</p>
                        </div>
                        <div>
                            <p class="text-gray-500 text-sm">–≠—Ç–∞–∂–µ–π</p>
                            <p class="font-semibold">{{ complex.real_floors_min or complex.floors_min or 17 }} - {{ complex.real_floors_max or complex.floors_max or 25 }} —ç—Ç–∞–∂</p>
                        </div>
                        <div>
                            <p class="text-gray-500 text-sm">–ö–æ—Ä–ø—É—Å–æ–≤</p>
                            <p class="font-semibold">{{ complex.real_buildings_count or complex.buildings_count or 3 }} –∫–æ—Ä–ø—É—Å–∞</p>
                        </div>
                        <div>
                            <p class="text-gray-500 text-sm">–ö–≤–∞—Ä—Ç–∏—Ä –≤ –ø—Ä–æ–¥–∞–∂–µ</p>
                            <p class="font-semibold">{{ properties|length }}</p>
                        </div>
                        <div>
                            <p class="text-gray-500 text-sm">–í—ã—Å–æ—Ç–∞ –ø–æ—Ç–æ–ª–∫–æ–≤</p>
                            <p class="font-semibold">{{ complex.ceiling_height or "–æ—Ç 3.2 –º" }}</p>
                        </div>
                        <div>
                            <p class="text-gray-500 text-sm">–ü–ª–æ—â–∞–¥—å –∫–≤–∞—Ä—Ç–∏—Ä</p>
                            <p class="font-semibold">{{ "{:.1f}".format(complex.real_area_from) if complex.real_area_from else "35" }} - {{ "{:.1f}".format(complex.real_area_to) if complex.real_area_to else "135" }} –º¬≤</p>
                        </div>
                        <div>
                            <p class="text-gray-500 text-sm">–ü–∞—Ä–∫–∏–Ω–≥</p>
                            <p class="font-semibold">{{ complex.parking or "–ø–æ–¥–∑–µ–º–Ω—ã–π" }}</p>
                        </div>
                    </div>

                    <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
                    <div class="mb-6">
                        <h3 class="font-bold text-lg mb-3">–û –∂–∏–ª–æ–º –∫–æ–º–ø–ª–µ–∫—Å–µ</h3>
                        <div class="mb-4 p-4 bg-gray-50 rounded-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 text-sm">–ó–∞—Å—Ç—Ä–æ–π—â–∏–∫</p>
                                    {% if complex.developer_id %}
                                    <a href="{{ url_for('developer_detail', developer_id=complex.developer_id) }}" class="font-semibold text-[#0088CC] hover:text-[#006699] hover:underline transition-colors text-lg">{{ complex.developer }}</a>
                                    {% else %}
                                    <p class="font-semibold text-lg">{{ complex.developer }}</p>
                                    {% endif %}
                                </div>
                                {% if complex.developer_id %}
                                <a href="{{ url_for('developer_detail', developer_id=complex.developer_id) }}" class="text-[#0088CC] hover:text-[#006699] text-sm flex items-center gap-1">
                                    –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–µ
                                    <i class="fas fa-arrow-right text-xs"></i>
                                </a>
                                {% endif %}
                            </div>
                        </div>
                        <p class="text-gray-700 mb-3">
                            {{ complex.description }}
                        </p>
                        {% if complex.detailed_description %}
                        <p class="text-gray-700">
                            {{ complex.detailed_description }}
                        </p>
                        {% else %}
                        <p class="text-gray-700">
                            –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∂–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å —Å —Ä–∞–∑–≤–∏—Ç–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π, —É–¥–æ–±–Ω—ã–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ–º –∏ –≤—ã—Å–æ–∫–∏–º –∫–∞—á–µ—Å—Ç–≤–æ–º —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞. –ù–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω—ã –∑–æ–Ω—ã –æ—Ç–¥—ã—Ö–∞, –¥–µ—Ç—Å–∫–∏–µ –∏ —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∫–∏.
                        </p>
                        {% endif %}
                    </div>

                    <!-- –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ -->
                    {% if complex.infrastructure %}
                    <div class="mb-6">
                        <h3 class="font-bold text-lg mb-3">–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞</h3>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                            {% for amenity in complex.infrastructure %}
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 bg-[#0088CC]/10 rounded-full flex items-center justify-center">
                                    <i class="fas fa-{{ amenity.icon }} text-sm text-[#0088CC]"></i>
                                </div>
                                <span class="text-sm">{{ amenity.name }}</span>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}

                    <!-- –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ -->
                    {% if complex.advantages %}
                    <div class="mb-6">
                        <h3 class="font-bold text-lg mb-3">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</h3>
                        <div class="space-y-3">
                            {% for advantage in complex.advantages %}
                            <div class="flex items-start gap-3">
                                <div class="flex-shrink-0 mt-1 text-[#0088CC]">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <p class="text-gray-700">{{ advantage }}</p>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}


                </div>

                <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ (—Ü–µ–Ω–∞ –∏ –∫—ç—à–±–µ–∫) -->
                <div class="md:w-80 flex-shrink-0">
                    <!-- –¶–µ–Ω–∞ -->
                    <div class="bg-gray-50 rounded-xl p-6 mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-bold">–°—Ç–æ–∏–º–æ—Å—Ç—å –∫–≤–∞—Ä—Ç–∏—Ä</h3>
                            <span class="text-sm text-gray-500">–æ—Ç</span>
                        </div>
                        <div class="text-2xl font-bold mb-2 bg-gradient-to-r from-[#006699] to-[#0088CC] bg-clip-text text-transparent">
                            {{ "{:,.0f}".format(complex.real_price_from if complex.real_price_from else complex.price_from).replace(',', ' ') }} ‚ÇΩ
                        </div>
                        {% if complex.real_price_to and complex.real_price_to != complex.real_price_from %}
                        <div class="text-lg text-gray-600 mb-4">
                            –¥–æ {{ "{:,.0f}".format(complex.real_price_to).replace(',', ' ') }} ‚ÇΩ
                        </div>
                        {% endif %}
                        <div class="text-sm text-gray-500 mb-4">
                            <div class="flex justify-between mb-1">
                                <span>–¶–µ–Ω–∞ –∑–∞ –º¬≤</span>
                                <span class="font-medium">–æ—Ç {{ "{:,.0f}".format(165000).replace(',', ' ') }} ‚ÇΩ</span>
                            </div>
                        </div>
                        <button class="w-full bg-gradient-to-r from-[#006699] to-[#0088CC] hover:bg-opacity-90 text-white font-semibold py-3 px-4 rounded-xl transition-all">
                            –ü–æ–∫–∞–∑–∞—Ç—å –∫–≤–∞—Ä—Ç–∏—Ä—ã
                        </button>
                    </div>
                    
                    <!-- –ö—ç—à–±–µ–∫ -->
                    <div class="bg-blue-50 rounded-xl p-6 mb-6 border border-blue-100">
                        <h3 class="font-bold text-lg mb-3 text-[#0088CC]">–í–∞—à –∫—ç—à–±–µ–∫</h3>
                        <div class="flex items-end gap-2 mb-2">
                            <span class="text-2xl font-bold text-[#0088CC]">–¥–æ {{ complex.cashback_percent }}%</span>
                            <span class="text-gray-500 mb-1">–æ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∫–≤–∞—Ä—Ç–∏—Ä—ã</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">
                            –ü—Ä–∏ –ø–æ–∫—É–ø–∫–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã –≤ —ç—Ç–æ–º –ñ–ö —á–µ—Ä–µ–∑ –Ω–∞—à —Å–µ—Ä–≤–∏—Å –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫—ç—à–±–µ–∫ –Ω–∞ –∫–∞—Ä—Ç—É –ø–æ—Å–ª–µ —Å–¥–µ–ª–∫–∏.
                        </p>
                        <button class="w-full bg-white hover:bg-gray-50 text-[#0088CC] font-semibold py-3 px-4 rounded-xl border border-[#0088CC] transition-all">
                            –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∫—ç—à–±–µ–∫
                        </button>
                    </div>
                    
                    <!-- –ò–ø–æ—Ç–µ–∫–∞ -->
                    <div class="bg-white rounded-xl p-6 border border-gray-200">
                        <h3 class="font-bold text-lg mb-3">–ò–ø–æ—Ç–µ–∫–∞ –æ—Ç {{ complex.mortgage_rate or 5.7 }}%</h3>
                        <p class="text-sm text-gray-600 mb-4">
                            –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –ø–æ –∏–ø–æ—Ç–µ–∫–µ –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π —ç—Ç–æ–≥–æ –∂–∏–ª–æ–≥–æ –∫–æ–º–ø–ª–µ–∫—Å–∞. –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –ø–ª–∞—Ç–µ–∂ –æ–Ω–ª–∞–π–Ω.
                        </p>
                        <button class="w-full bg-gray-900 hover:bg-gray-700 text-white font-semibold py-3 px-4 rounded-xl transition-all">
                            –û—Ñ–æ—Ä–º–∏—Ç—å –∏–ø–æ—Ç–µ–∫—É
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –í–∏–¥–µ–æ –æ –∫–æ–º–ø–ª–µ–∫—Å–µ -->
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
        <h2 class="text-2xl font-bold mb-6">–í–∏–¥–µ–æ –æ –∫–æ–º–ø–ª–µ–∫—Å–µ</h2>
        <div class="aspect-video w-full bg-gray-200 rounded-xl overflow-hidden">
            <iframe 
                width="100%" 
                height="100%" 
                src="https://www.youtube.com/embed/dQw4w9WgXcQ" 
                title="–í–∏–¥–µ–æ –æ–±–∑–æ—Ä –ñ–ö {{ complex.name }}" 
                frameborder="0" 
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                allowfullscreen>
            </iframe>
        </div>
        <p class="text-sm text-gray-500 mt-3">
            –í–∏–¥–µ–æ–æ–±–∑–æ—Ä –∂–∏–ª–æ–≥–æ –∫–æ–º–ø–ª–µ–∫—Å–∞ {{ complex.name }}: –ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∏, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞.
        </p>
    </div>

    <!-- –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–ª–µ–∫—Å–∞ -->
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
        <h2 class="text-2xl font-bold mb-6">–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–ª–µ–∫—Å–∞</h2>
        <div class="grid md:grid-cols-2 gap-6">
            <div class="space-y-4">
                <div class="flex items-start gap-3">
                    <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                        <i class="fas fa-building text-sm text-[#0088CC]"></i>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-1">–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</h4>
                        <p class="text-gray-600 text-sm">–ñ–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º —Å—Ç–∏–ª–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ–∞—Å–∞–¥–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏ —ç–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π.</p>
                    </div>
                </div>
                
                <div class="flex items-start gap-3">
                    <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                        <i class="fas fa-tree text-sm text-green-600"></i>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-1">–ó–µ–ª–µ–Ω—ã–µ –∑–æ–Ω—ã</h4>
                        <p class="text-gray-600 text-sm">–ë–ª–∞–≥–æ—É—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è —Å –ª–∞–Ω–¥—à–∞—Ñ—Ç–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º, –∑–æ–Ω–∞–º–∏ –æ—Ç–¥—ã—Ö–∞ –∏ –¥–µ—Ç—Å–∫–∏–º–∏ –ø–ª–æ—â–∞–¥–∫–∞–º–∏ –µ–≤—Ä–æ–ø–µ–π—Å–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è.</p>
                    </div>
                </div>

                <div class="flex items-start gap-3">
                    <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                        <i class="fas fa-shield-alt text-sm text-[#0088CC]"></i>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-1">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h4>
                        <p class="text-gray-600 text-sm">–ó–∞–∫—Ä—ã—Ç–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è —Å –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ–º, –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –¥–æ—Å—Ç—É–ø–∞ –∏ –∫–æ–Ω—Å—å–µ—Ä–∂-—Å–µ—Ä–≤–∏—Å–æ–º –≤ –∫–∞–∂–¥–æ–º –∫–æ—Ä–ø—É—Å–µ.</p>
                    </div>
                </div>
            </div>
            
            <div class="space-y-4">
                <div class="flex items-start gap-3">
                    <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                        <i class="fas fa-car text-sm text-[#0088CC]"></i>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-1">–£–¥–æ–±–Ω–∞—è –ø–∞—Ä–∫–æ–≤–∫–∞</h4>
                        <p class="text-gray-600 text-sm">{{ complex.parking or "–ü–æ–¥–∑–µ–º–Ω—ã–π –ø–∞—Ä–∫–∏–Ω–≥" }} —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ–∫—É–ø–∫–∏ –∏ –∞—Ä–µ–Ω–¥—ã –º–∞—à–∏–Ω–æ–º–µ—Å—Ç. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≥–æ—Å—Ç–µ–≤—ã–µ –º–µ—Å—Ç–∞.</p>
                    </div>
                </div>

                <div class="flex items-start gap-3">
                    <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                        <i class="fas fa-tools text-sm text-[#0088CC]"></i>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-1">–ö–∞—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞</h4>
                        <p class="text-gray-600 text-sm">{{ complex.building_type or "–ú–æ–Ω–æ–ª–∏—Ç–Ω–æ-–∫–∏—Ä–ø–∏—á–Ω–∞—è" }} —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π.</p>
                    </div>
                </div>

                <div class="flex items-start gap-3">
                    <div class="w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                        <i class="fas fa-cogs text-sm text-indigo-600"></i>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-1">–ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã</h4>
                        <p class="text-gray-600 text-sm">–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –æ—Ç–æ–ø–ª–µ–Ω–∏—è, –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏ –∏ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ –æ—Ç–æ–ø–ª–µ–Ω–∏–µ –∏ —Å—á–µ—Ç—á–∏–∫–∏.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –¢–∏–ø—ã –∫–≤–∞—Ä—Ç–∏—Ä (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ) -->
    {% if complex.real_room_stats %}
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
        <h2 class="text-2xl font-bold mb-6">–¢–∏–ø—ã –∫–≤–∞—Ä—Ç–∏—Ä –≤ –∫–æ–º–ø–ª–µ–∫—Å–µ</h2>
        
        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
            {% for room_type, stats in complex.real_room_stats.items() %}
            <div class="border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow cursor-pointer" onclick="filterByType('{{ room_type }}')">
                <h3 class="font-bold text-lg mb-2 text-center">{{ room_type }}</h3>
                <div class="space-y-2 text-sm">
                    <div class="flex justify-between">
                        <span class="text-gray-500">–ö–≤–∞—Ä—Ç–∏—Ä:</span>
                        <span class="font-medium text-[#0088CC] text-lg">{{ stats.count }}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-500">–ü–ª–æ—â–∞–¥—å:</span>
                        <span class="font-medium">{{ "{:.1f}".format(stats.min_area) }}-{{ "{:.1f}".format(stats.max_area) }} –º¬≤</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-500">–¶–µ–Ω–∞:</span>
                        <span class="font-medium">{{ "{:.1f}".format(stats.min_price / 1000000) }}-{{ "{:.1f}".format(stats.max_price / 1000000) }} –º–ª–Ω ‚ÇΩ</span>
                    </div>
                </div>
                <button class="w-full mt-3 text-[#0088CC] font-medium text-sm hover:bg-blue-50 py-2 rounded-lg transition border border-[#0088CC]/20">
                    –°–º–æ—Ç—Ä–µ—Ç—å –∫–≤–∞—Ä—Ç–∏—Ä—ã
                </button>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- –ö–≤–∞—Ä—Ç–∏—Ä—ã –≤ –ø—Ä–æ–¥–∞–∂–µ -->
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
        <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-6">
            <h2 class="text-2xl font-bold mb-4 md:mb-0">–ö–≤–∞—Ä—Ç–∏—Ä—ã –≤ –ø—Ä–æ–¥–∞–∂–µ ({{ properties|length }})</h2>
            <div class="flex gap-3">
                <select id="typeFilter" class="border border-gray-300 rounded-lg px-3 py-2 text-sm" onchange="filterProperties()">
                    <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                    <option value="0">–°—Ç—É–¥–∏—è</option>
                    <option value="1">1-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
                    <option value="2">2-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
                    <option value="3">3-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
                    <option value="4">4+ –∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
                </select>
                <button onclick="setViewMode('grid')" id="gridViewBtn" class="px-4 py-2 border border-[#0088CC] text-[#0088CC] rounded-lg hover:bg-[#0088CC] hover:text-white transition">
                    <i class="fas fa-th mr-2"></i>–ö–∞—Ä—Ç–æ—á–∫–∏
                </button>
                <button onclick="setViewMode('list')" id="listViewBtn" class="px-4 py-2 border border-[#0088CC] text-[#0088CC] rounded-lg hover:bg-[#0088CC] hover:text-white transition">
                    <i class="fas fa-list mr-2"></i>–°–ø–∏—Å–æ–∫
                </button>
            </div>
        </div>

        <!-- Properties Grid -->
        <div id="propertiesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for property in properties %}
            <div class="property-card bg-white border border-gray-200 rounded-xl overflow-hidden hover:shadow-lg transition-shadow">
                <div class="relative">
                    <img src="{{ property.image }}" alt="{{ property.title }}" class="w-full h-48 object-cover">
                    <div class="absolute top-3 left-3 bg-white/90 backdrop-blur px-2 py-1 rounded-full text-xs font-medium">
                        {{ property.rooms }}{% if property.rooms == 0 %}–°—Ç—É–¥–∏—è{% else %}-–∫–æ–º–Ω{% endif %}
                    </div>
                    <div class="absolute top-3 right-3 bg-amber-400 text-gray-900 px-2 py-1 rounded-full text-xs font-bold">
                        –ö—ç—à–±–µ–∫ {{ "{:,.0f}".format(property.price * 0.035).replace(',', ' ') }} ‚ÇΩ
                    </div>
                </div>
                
                <div class="p-4">
                    <h3 class="font-semibold text-lg mb-2 line-clamp-2">{{ property.title }}</h3>
                    
                    <div class="grid grid-cols-2 gap-3 mb-4 text-sm text-gray-600">
                        <div class="flex items-center">
                            <i class="fas fa-expand-arrows-alt mr-2 text-[#0088CC]"></i>
                            {{ property.area }} –º¬≤
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-building mr-2 text-[#0088CC]"></i>
                            {{ property.floor }}/{{ property.total_floors }} —ç—Ç
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-calendar mr-2 text-[#0088CC]"></i>
                            {{ property.completion_date }}
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-home mr-2 text-[#0088CC]"></i>
                            {{ property.property_type }}
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <div class="text-2xl font-bold text-[#0088CC] mb-1">
                            {{ "{:,.0f}".format(property.price).replace(',', ' ') }} ‚ÇΩ
                        </div>
                        <div class="text-sm text-gray-500">
                            {{ "{:,.0f}".format(property.price / property.area).replace(',', ' ') }} ‚ÇΩ/–º¬≤
                        </div>
                    </div>
                    
                    <div class="flex gap-2">
                        <a href="{{ url_for('property_detail', property_id=property.id) }}" class="flex-1 bg-gradient-to-r from-[#006699] to-[#0088CC] text-white text-center py-2 px-4 rounded-lg font-medium hover:opacity-90 transition text-sm">
                            –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                        </a>
                        <button onclick="addToFavorites({{ property.id }})" class="px-3 py-2 border border-[#0088CC] text-[#0088CC] rounded-lg hover:bg-[#0088CC] hover:text-white transition">
                            <i class="fas fa-heart"></i>
                        </button>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Properties List -->
        <div id="propertiesList" class="hidden space-y-4">
            {% for property in properties %}
            <div class="property-row bg-white border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow">
                <div class="flex flex-col md:flex-row gap-4">
                    <div class="w-full md:w-48 h-32 md:h-24 flex-shrink-0">
                        <img src="{{ property.image }}" alt="{{ property.title }}" class="w-full h-full object-cover rounded-lg">
                    </div>
                    
                    <div class="flex-1 min-w-0">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-semibold text-lg">{{ property.title }}</h3>
                            <div class="text-right">
                                <div class="text-xl font-bold text-[#0088CC]">
                                    {{ "{:,.0f}".format(property.price).replace(',', ' ') }} ‚ÇΩ
                                </div>
                                <div class="text-sm text-gray-500">
                                    {{ "{:,.0f}".format(property.price / property.area).replace(',', ' ') }} ‚ÇΩ/–º¬≤
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex flex-wrap gap-4 mb-3 text-sm text-gray-600">
                            <span>{{ property.rooms }}{% if property.rooms == 0 %}–°—Ç—É–¥–∏—è{% else %}-–∫–æ–º–Ω{% endif %}</span>
                            <span>{{ property.area }} –º¬≤</span>
                            <span>{{ property.floor }}/{{ property.total_floors }} —ç—Ç</span>
                            <span>{{ property.completion_date }}</span>
                            <span class="text-[#0088CC] font-medium">–ö—ç—à–±–µ–∫ {{ "{:,.0f}".format(property.price * 0.035).replace(',', ' ') }} ‚ÇΩ</span>
                        </div>
                        
                        <div class="flex gap-2">
                            <a href="{{ url_for('property_detail', property_id=property.id) }}" class="bg-gradient-to-r from-[#006699] to-[#0088CC] text-white px-4 py-2 rounded-lg font-medium hover:opacity-90 transition text-sm">
                                –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                            </a>
                            <button onclick="addToFavorites({{ property.id }})" class="px-3 py-2 border border-[#0088CC] text-[#0088CC] rounded-lg hover:bg-[#0088CC] hover:text-white transition">
                                <i class="fas fa-heart"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        {% if not properties %}
        <div class="text-center py-12">
            <div class="text-gray-400 text-6xl mb-4">üè†</div>
            <h3 class="text-xl font-semibold text-gray-600 mb-2">–ö–≤–∞—Ä—Ç–∏—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
            <p class="text-gray-500">–í –¥–∞–Ω–Ω–æ–º –ñ–ö –ø–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–≤–∞—Ä—Ç–∏—Ä</p>
        </div>
        {% endif %}
    </div>

    <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–∞ -->
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
        <h2 class="text-2xl font-bold mb-6">–ó–∞—Å—Ç—Ä–æ–π—â–∏–∫</h2>
        <div class="flex flex-col md:flex-row gap-6">
            <div class="flex-1">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-12 h-12 bg-[#0088CC]/10 rounded-full flex items-center justify-center">
                        <i class="fas fa-building text-[#0088CC]"></i>
                    </div>
                    <div>
                        {% if complex.developer_id %}
                        <a href="{{ url_for('developer_detail', developer_id=complex.developer_id) }}" class="font-bold text-lg text-[#0088CC] hover:text-[#006699] hover:underline transition-colors">{{ complex.developer }}</a>
                        {% else %}
                        <h3 class="font-bold text-lg">{{ complex.developer }}</h3>
                        {% endif %}
                        <p class="text-gray-500 text-sm">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫</p>
                    </div>
                </div>
                
                <p class="text-gray-600 mb-4">
                    –ó–∞—Å—Ç—Ä–æ–π—â–∏–∫ —Å –º–Ω–æ–≥–æ–ª–µ—Ç–Ω–∏–º –æ–ø—ã—Ç–æ–º —Ä–∞–±–æ—Ç—ã –Ω–∞ —Ä—ã–Ω–∫–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä–∞. 
                    –í –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –∫–æ–º–ø–∞–Ω–∏–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∂–∏–ª—ã—Ö –∫–æ–º–ø–ª–µ–∫—Å–æ–≤ —Ä–∞–∑–ª–∏—á–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞.
                </p>
                
                <div class="space-y-2">
                    <div class="flex items-center gap-2 text-gray-600">
                        <i class="fas fa-phone text-[#0088CC]"></i>
                        <span>+7 (861) 123-45-67</span>
                    </div>
                    <div class="flex items-center gap-2 text-gray-600">
                        <i class="fas fa-envelope text-[#0088CC]"></i>
                        <span>info@developer.ru</span>
                    </div>
                    <div class="flex items-center gap-2 text-gray-600">
                        <i class="fas fa-globe text-[#0088CC]"></i>
                        <span>www.developer.ru</span>
                    </div>
                </div>
            </div>
            
            <div class="md:w-80">
                <div class="bg-gray-50 rounded-xl p-4">
                    <h4 class="font-semibold mb-3">–°–≤—è–∑–∞—Ç—å—Å—è —Å –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–æ–º</h4>
                    <button class="w-full bg-gradient-to-r from-[#006699] to-[#0088CC] text-white py-3 px-4 rounded-lg font-medium hover:opacity-90 transition mb-3">
                        –û—Ç–¥–µ–ª –ø—Ä–æ–¥–∞–∂
                    </button>
                    <button class="w-full border border-[#0088CC] text-[#0088CC] py-3 px-4 rounded-lg font-medium hover:bg-[#0088CC] hover:text-white transition">
                        –û—Ñ–∏—Å –ø—Ä–æ–¥–∞–∂ –Ω–∞ –∫–∞—Ä—Ç–µ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ -->
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
        <h2 class="text-2xl font-bold mb-6">–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ</h2>
        <div id="complex-map" class="w-full h-96 bg-gray-200 rounded-xl mb-4"></div>
        <div class="grid md:grid-cols-3 gap-4 text-sm">
            <div>
                <h4 class="font-semibold mb-2 text-[#0088CC]">–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</h4>
                <ul class="space-y-1 text-gray-600">
                    <li>‚Ä¢ –ê–≤—Ç–æ–±—É—Å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Äî 200 –º</li>
                    <li>‚Ä¢ –¢—Ä–æ–ª–ª–µ–π–±—É—Å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Äî 350 –º</li>
                    <li>‚Ä¢ –ñ/–¥ —Å—Ç–∞–Ω—Ü–∏—è ‚Äî 2.5 –∫–º</li>
                </ul>
            </div>
            <div>
                <h4 class="font-semibold mb-2 text-[#0088CC]">–¢–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã</h4>
                <ul class="space-y-1 text-gray-600">
                    <li>‚Ä¢ –¢–¶ "–ì–∞–ª–∞–∫—Ç–∏–∫–∞" ‚Äî 800 –º</li>
                    <li>‚Ä¢ –¢–¶ "–ö—Ä–∞—Å–Ω–∞—è –ø–ª–æ—â–∞–¥—å" ‚Äî 1.2 –∫–º</li>
                    <li>‚Ä¢ –¢–¶ "OZ –ú–æ–ª–ª" ‚Äî 3.5 –∫–º</li>
                </ul>
            </div>
            <div>
                <h4 class="font-semibold mb-2 text-[#0088CC]">–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</h4>
                <ul class="space-y-1 text-gray-600">
                    <li>‚Ä¢ –î–µ—Ç—Å–∫–∏–π —Å–∞–¥ ‚Ññ 126 ‚Äî 300 –º</li>
                    <li>‚Ä¢ –®–∫–æ–ª–∞ ‚Ññ 53 ‚Äî 600 –º</li>
                    <li>‚Ä¢ –ö—É–±–ì–£ ‚Äî 4.2 –∫–º</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- –ü–æ—Ö–æ–∂–∏–µ –ñ–ö -->
    <div class="bg-white rounded-2xl shadow-lg p-6">
        <h2 class="text-2xl font-bold mb-6">–ü–æ—Ö–æ–∂–∏–µ –∂–∏–ª—ã–µ –∫–æ–º–ø–ª–µ–∫—Å—ã</h2>
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Sample similar complex cards -->
            <div class="border border-gray-200 rounded-xl overflow-hidden hover:shadow-lg transition-shadow">
                <img src="https://via.placeholder.com/300x200" alt="–ñ–ö –ï–≤—Ä–æ–ø–µ–π—Å–∫–∏–π" class="w-full h-48 object-cover">
                <div class="p-4">
                    <h3 class="font-semibold text-lg mb-2">–ñ–ö "–ï–≤—Ä–æ–ø–µ–π—Å–∫–∏–π"</h3>
                    <p class="text-gray-600 text-sm mb-3">–ü—Ä–∏–∫—É–±–∞–Ω—Å–∫–∏–π –æ–∫—Ä—É–≥, —É–ª. –ï–≤—Ä–æ–ø–µ–π—Å–∫–∞—è</p>
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-lg font-bold text-[#0088CC]">–æ—Ç 4.2 –º–ª–Ω ‚ÇΩ</span>
                        <span class="text-sm text-gray-500">–¥–æ 3.5%</span>
                    </div>
                    <button class="w-full border border-[#0088CC] text-[#0088CC] py-2 px-4 rounded-lg font-medium hover:bg-[#0088CC] hover:text-white transition text-sm">
                        –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                    </button>
                </div>
            </div>
            
            <div class="border border-gray-200 rounded-xl overflow-hidden hover:shadow-lg transition-shadow">
                <img src="https://via.placeholder.com/300x200" alt="–ñ–ö –î–∏–Ω–∞—Å—Ç–∏—è" class="w-full h-48 object-cover">
                <div class="p-4">
                    <h3 class="font-semibold text-lg mb-2">–ñ–ö "–î–∏–Ω–∞—Å—Ç–∏—è"</h3>
                    <p class="text-gray-600 text-sm mb-3">–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –æ–∫—Ä—É–≥, —É–ª. –ö—Ä–∞—Å–Ω–∞—è</p>
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-lg font-bold text-[#0088CC]">–æ—Ç 5.8 –º–ª–Ω ‚ÇΩ</span>
                        <span class="text-sm text-gray-500">–¥–æ 4.0%</span>
                    </div>
                    <button class="w-full border border-[#0088CC] text-[#0088CC] py-2 px-4 rounded-lg font-medium hover:bg-[#0088CC] hover:text-white transition text-sm">
                        –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                    </button>
                </div>
            </div>
            
            <div class="border border-gray-200 rounded-xl overflow-hidden hover:shadow-lg transition-shadow">
                <img src="https://via.placeholder.com/300x200" alt="–ñ–ö –°–æ–ª–Ω–µ—á–Ω—ã–π" class="w-full h-48 object-cover">
                <div class="p-4">
                    <h3 class="font-semibold text-lg mb-2">–ñ–ö "–°–æ–ª–Ω–µ—á–Ω—ã–π"</h3>
                    <p class="text-gray-600 text-sm mb-3">–ó–∞–ø–∞–¥–Ω—ã–π –æ–∫—Ä—É–≥, —É–ª. –°–æ–ª–Ω–µ—á–Ω–∞—è</p>
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-lg font-bold text-[#0088CC]">–æ—Ç 3.9 –º–ª–Ω ‚ÇΩ</span>
                        <span class="text-sm text-gray-500">–¥–æ 3.0%</span>
                    </div>
                    <button class="w-full border border-[#0088CC] text-[#0088CC] py-2 px-4 rounded-lg font-medium hover:bg-[#0088CC] hover:text-white transition text-sm">
                        –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
    // Map initialization for complex location
    var complexLat = 45.0355; // Default coordinates for Krasnodar
    var complexLng = 38.9753;
    
    // Check if complex has coordinates
    {% if complex.coordinates and complex.coordinates|length >= 2 %}
    complexLat = {{ complex.coordinates[0] }};
    complexLng = {{ complex.coordinates[1] }};
    {% endif %}
    
    const complexMap = L.map('complex-map').setView([complexLat, complexLng], 15);
    
    // Add OpenStreetMap tiles
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap contributors'
    }).addTo(complexMap);
    
    // Custom complex marker icon
    const complexIcon = L.divIcon({
        className: 'custom-complex-marker',
        html: '<div class="w-10 h-10 bg-blue-600 border-2 border-white rounded-full shadow-lg flex items-center justify-center"><i class="fas fa-building text-white text-sm"></i></div>',
        iconSize: [40, 40],
        iconAnchor: [20, 20]
    });
    
    // Create popup content
    var popupContent = '<div class="text-center p-2">' +
        '<div class="font-semibold text-blue-600 mb-1">{{ complex.name }}</div>' +
        '<div class="text-sm text-gray-600 mb-2">{{ complex.district or "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä" }}</div>' +
        '<div class="text-lg font-bold text-blue-600">–æ—Ç {{ "{:,.0f}".format(complex.real_price_from if complex.real_price_from else complex.price_from).replace(",", " ") }} ‚ÇΩ</div>' +
        '</div>';
    
    // Add complex marker
    const complexMarker = L.marker([complexLat, complexLng], { icon: complexIcon })
        .addTo(complexMap)
        .bindPopup(popupContent)
        .openPopup();

    // Gallery functionality
    let currentGallerySlide = 0;
    const totalGallerySlides = 3;

    function nextGallerySlide() {
        currentGallerySlide = (currentGallerySlide + 1) % totalGallerySlides;
        updateGallerySlide();
    }

    function prevGallerySlide() {
        currentGallerySlide = (currentGallerySlide - 1 + totalGallerySlides) % totalGallerySlides;
        updateGallerySlide();
    }

    function goToGallerySlide(index) {
        currentGallerySlide = index;
        updateGallerySlide();
    }

    function updateGallerySlide() {
        const slides = document.querySelector('.gallery-slides');
        const dots = document.querySelectorAll('.gallery-dot');
        
        slides.style.transform = `translateX(-${currentGallerySlide * 100}%)`;
        
        dots.forEach((dot, index) => {
            dot.classList.toggle('active', index === currentGallerySlide);
        });
    }

    // Property filtering
    function filterProperties() {
        const typeFilter = document.getElementById('typeFilter').value;
        const propertyCards = document.querySelectorAll('.property-card, .property-row');
        
        propertyCards.forEach(card => {
            if (typeFilter === '') {
                card.style.display = '';
            } else {
                const roomType = card.querySelector('[data-rooms]')?.dataset.rooms || '1';
                card.style.display = roomType === typeFilter ? '' : 'none';
            }
        });
    }

    // View mode switching
    function setViewMode(mode) {
        const gridView = document.getElementById('propertiesGrid');
        const listView = document.getElementById('propertiesList');
        const gridBtn = document.getElementById('gridViewBtn');
        const listBtn = document.getElementById('listViewBtn');
        
        if (mode === 'grid') {
            gridView.classList.remove('hidden');
            listView.classList.add('hidden');
            gridBtn.classList.add('bg-[#0088CC]', 'text-white');
            gridBtn.classList.remove('text-[#0088CC]');
            listBtn.classList.remove('bg-[#0088CC]', 'text-white');
            listBtn.classList.add('text-[#0088CC]');
        } else {
            gridView.classList.add('hidden');
            listView.classList.remove('hidden');
            listBtn.classList.add('bg-[#0088CC]', 'text-white');
            listBtn.classList.remove('text-[#0088CC]');
            gridBtn.classList.remove('bg-[#0088CC]', 'text-white');
            gridBtn.classList.add('text-[#0088CC]');
        }
    }

    // Filter by room type from stats cards
    function filterByType(roomType) {
        const typeFilter = document.getElementById('typeFilter');
        const roomMap = {
            '–°—Ç—É–¥–∏—è': '0',
            '1-–∫–æ–º–Ω–∞—Ç–Ω–∞—è': '1', 
            '2-–∫–æ–º–Ω–∞—Ç–Ω–∞—è': '2',
            '3-–∫–æ–º–Ω–∞—Ç–Ω–∞—è': '3',
            '4+ –∫–æ–º–Ω–∞—Ç–Ω–∞—è': '4'
        };
        
        typeFilter.value = roomMap[roomType] || '';
        filterProperties();
        
        // Scroll to properties section
        document.querySelector('[data-section="properties"]')?.scrollIntoView({ behavior: 'smooth' });
    }

    // Add to favorites functionality
    function addToFavorites(propertyId) {
        // Implementation for favorites
        console.log('Adding property to favorites:', propertyId);
    }
</script>
{% endblock %}