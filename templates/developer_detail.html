{% extends "base.html" %}

{% block title %}{{ developer.name }} - –ó–∞—Å—Ç—Ä–æ–π—â–∏–∫ —Å –∫—ç—à–±–µ–∫–æ–º{% endblock %}

{% block content %}
<!-- Breadcrumbs -->
<div class="container mx-auto px-4 py-3 text-sm">
    <nav aria-label="Breadcrumb" class="flex">
        <ol class="inline-flex items-center space-x-1 md:space-x-3">
            <li class="inline-flex items-center">
                <a class="text-[#0088CC] hover:underline inline-flex items-center" href="/">
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path>
                    </svg>
                    –ì–ª–∞–≤–Ω–∞—è
                </a>
            </li>
            <li>
                <div class="flex items-center">
                    <svg class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    <a href="{{ url_for('developers') }}" class="text-[#0088CC] hover:underline ml-1 md:ml-2">–ó–∞—Å—Ç—Ä–æ–π—â–∏–∫–∏</a>
                </div>
            </li>
            <li aria-current="page">
                <div class="flex items-center">
                    <svg class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    <span class="text-gray-500 ml-1 md:ml-2">{{ developer.name }}</span>
                </div>
            </li>
        </ol>
    </nav>
</div>

<div class="max-w-6xl mx-auto px-4 py-12">
    <!-- Developer Header Section -->
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
        <div class="flex flex-col md:flex-row gap-6 items-start">
            <div class="w-32 h-32 rounded-xl overflow-hidden bg-gray-100 flex-shrink-0 flex items-center justify-center">
                {% if developer.logo %}
                <img alt="–õ–æ–≥–æ—Ç–∏–ø {{ developer.name }}" class="w-full h-full object-contain" src="{{ developer.logo }}"/>
                {% else %}
                <span class="text-4xl font-bold text-gray-400">{{ developer.short_name }}</span>
                {% endif %}
            </div>
            <div class="flex-1">
                <h1 class="text-3xl font-bold mb-2">{{ developer.name }}</h1>
                <div class="flex flex-wrap gap-2 mb-4">
                    <span class="bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm">–ó–∞—Å—Ç—Ä–æ–π—â–∏–∫</span>
                    <span class="bg-gray-100 text-green-800 px-3 py-1 rounded-full text-sm">–†–∞–±–æ—Ç–∞–µ—Ç —Å {{ developer.founded_year }}</span>
                    {% if developer.specialization %}
                    <span class="bg-gray-100 text-purple-800 px-3 py-1 rounded-full text-sm">{{ developer.specialization }}</span>
                    {% endif %}
                </div>
                <p class="text-gray-600 mb-4">{{ developer.description }}</p>
                <div class="flex flex-col sm:flex-row sm:items-center gap-4 text-gray-600">
                    <div class="flex items-center gap-2">
                        <i class="fas fa-phone-alt text-[#0088CC]"></i>
                        <span>{{ developer.phone }}</span>
                    </div>
                    {% if developer.website %}
                    <div class="flex items-center gap-2">
                        <i class="fas fa-globe text-[#0088CC]"></i>
                        <span>{{ developer.website }}</span>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Search and Stats Section -->
    <div class="bg-white rounded-xl shadow-sm p-6 mb-8">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
            <h2 class="text-xl font-bold">–ü–æ–∏—Å–∫ –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–∞</h2>
            <div class="relative w-full md:w-96">
                <input class="w-full border border-gray-300 rounded-xl pl-10 pr-4 py-2 focus:ring-2 focus:ring-[#0088CC] focus:border-transparent" 
                       placeholder="–ù–∞–π—Ç–∏ –ñ–ö –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ —Ä–∞–π–æ–Ω—É" type="text" id="complexSearch"/>
                <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
            </div>
        </div>
        
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
            <div class="bg-gray-50 rounded-xl p-4">
                <div class="text-gray-500 text-sm mb-1">–ü–æ—Å—Ç—Ä–æ–µ–Ω–æ –ñ–ö</div>
                <div class="text-2xl font-bold text-[#0088CC]">{{ developer.completed_projects or 0 }}</div>
            </div>
            <div class="bg-gray-50 rounded-xl p-4">
                <div class="text-gray-500 text-sm mb-1">–í—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–æ–≤</div>
                <div class="text-2xl font-bold text-[#0088CC]">{{ developer.complexes_count or 0 }}</div>
            </div>
            <div class="bg-gray-50 rounded-xl p-4">
                <div class="text-gray-500 text-sm mb-1">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥</div>
                <div class="text-2xl font-bold text-[#0088CC]">{{ developer.rating or '4.2' }}</div>
            </div>
            <div class="bg-gray-50 rounded-xl p-4">
                <div class="text-gray-500 text-sm mb-1">–ù–∞ —Ä—ã–Ω–∫–µ</div>
                <div class="text-2xl font-bold text-[#0088CC]">{{ (2024 - (developer.founded_year or 2020)) if developer.founded_year else "4+" }} –ª–µ—Ç</div>
            </div>
        </div>
    </div>

    <!-- –û –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–µ -->
    <div class="bg-white rounded-xl shadow-sm p-6 mb-8">
        <h2 class="text-xl font-bold mb-4">–û –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–µ</h2>
        <div class="prose max-w-none text-gray-700 mb-6">
            <p>{{ developer.detailed_description or developer.description or '–û–¥–∏–Ω –∏–∑ –≤–µ–¥—É—â–∏—Ö –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–æ–≤ —Ä–µ–≥–∏–æ–Ω–∞ —Å –º–Ω–æ–≥–æ–ª–µ—Ç–Ω–∏–º –æ–ø—ã—Ç–æ–º —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∂–∏–ª—å—è.' }}</p>
        </div>
        
        <!-- –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–∞ -->
        <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
            <div>
                <p class="text-gray-500 text-sm">–ì–æ–¥ –æ—Å–Ω–æ–≤–∞–Ω–∏—è</p>
                <p class="font-semibold">{{ developer.founded_year }}</p>
            </div>
            <div>
                <p class="text-gray-500 text-sm">–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ñ–ö</p>
                <p class="font-semibold">{{ developer.completed_projects or developer.complexes_count or 0 }}</p>
            </div>
            <div>
                <p class="text-gray-500 text-sm">–ö–≤–∞—Ä—Ç–∏—Ä –ø—Ä–æ–¥–∞–Ω–æ</p>
                <p class="font-semibold">{{ "{:,.0f}".format(developer.properties_count or 0).replace(',', ' ') }}+</p>
            </div>
            <div>
                <p class="text-gray-500 text-sm">–†–µ–π—Ç–∏–Ω–≥</p>
                <p class="font-semibold">{{ developer.rating or '4.2' }}/5</p>
            </div>
            <div>
                <p class="text-gray-500 text-sm">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞</p>
                <p class="font-semibold">{{ developer.construction_technology or "–†–∞–∑–ª–∏—á–Ω—ã–µ" }}</p>
            </div>
            <div>
                <p class="text-gray-500 text-sm">–ì–∞—Ä–∞–Ω—Ç–∏—è</p>
                <p class="font-semibold">{{ developer.warranty_years or 5 }} –ª–µ—Ç</p>
            </div>
        </div>

        <!-- –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ -->
        <div>
            <h3 class="font-bold mb-3">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–∞</h3>
            <div class="space-y-2">
                {% for advantage in developer.advantages %}
                <div class="flex items-start gap-3">
                    <div class="flex-shrink-0 mt-1 text-green-600">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <p class="text-gray-700">{{ advantage }}</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- –ñ–∏–ª—ã–µ –∫–æ–º–ø–ª–µ–∫—Å—ã -->
    <div class="bg-white rounded-xl shadow-sm p-6 mb-8">
        <h2 class="text-xl font-bold mb-6">–ñ–∏–ª—ã–µ –∫–æ–º–ø–ª–µ–∫—Å—ã –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–∞</h2>
        
        {% if complexes %}
        <div class="grid md:grid-cols-2 gap-6">
            {% for complex in complexes %}
            <div class="border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow complex-card" 
                 data-name="{{ complex.name.lower() }}" 
                 data-district="{{ (complex.get('district', '') or complex.get('location', '') or '').lower() }}">
                <div class="flex gap-4">
                    <div class="w-20 h-20 bg-gray-200 rounded-lg flex-shrink-0 overflow-hidden">
                        <img src="{{ complex.image }}" alt="{{ complex.name }}" class="w-full h-full object-cover">
                    </div>
                    <div class="flex-1">
                        <h3 class="font-bold text-lg mb-1">{{ complex.name }}</h3>
                        <p class="text-gray-600 text-sm mb-2">{{ complex.location }}</p>
                        <div class="flex flex-wrap gap-2 mb-3">
                            <span class="bg-blue-50 text-[#006699] px-2 py-1 rounded-full text-xs">{{ complex.class or "–ö–æ–º—Ñ–æ—Ä—Ç" }}</span>
                            <span class="bg-green-50 text-green-700 px-2 py-1 rounded-full text-xs">{{ complex.completion_date or "2024" }}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <div class="text-sm text-gray-500">
                                {% if complex.min_price %}
                                –æ—Ç {{ "{:,.0f}".format(complex.min_price).replace(',', ' ') }} ‚ÇΩ
                                {% endif %}
                            </div>
                            <a href="/zk/{{ complex.name|slug }}" 
                               class="text-[#0088CC] hover:text-[#006699] font-medium text-sm">
                                –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="text-center py-12">
            <div class="text-gray-400 text-6xl mb-4">üèóÔ∏è</div>
            <h3 class="text-xl font-semibold text-gray-600 mb-2">–ü—Ä–æ–µ–∫—Ç—ã –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</h3>
            <p class="text-gray-500">–≠—Ç–æ—Ç –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥ –Ω–æ–≤—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏</p>
        </div>
        {% endif %}
    </div>

    <!-- –ö–≤–∞—Ä—Ç–∏—Ä—ã –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–∞ -->
    {% if apartments %}
    <div class="bg-white rounded-xl shadow-sm p-6 mb-8">
        <h2 class="text-xl font-bold mb-6">–ö–≤–∞—Ä—Ç–∏—Ä—ã –≤ –ø—Ä–æ–¥–∞–∂–µ ({{ apartments|length }})</h2>
        
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
            {% for apartment in apartments[:12] %}
            <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                <div class="flex justify-between items-start mb-3">
                    <div>
                        <h4 class="font-semibold text-lg">
                            {% if apartment.object_rooms == 0 %}
                                –°—Ç—É–¥–∏—è
                            {% else %}
                                {{ apartment.object_rooms }}-–∫–æ–º–Ω.
                            {% endif %}
                        </h4>
                        <p class="text-gray-600 text-sm">{{ apartment.complex_name }}</p>
                    </div>
                    <div class="text-right">
                        <p class="font-bold text-[#0088CC]">{{ "{:,.0f}".format(apartment.price).replace(',', ' ') }} ‚ÇΩ</p>
                        <p class="text-gray-500 text-xs">{{ apartment.object_area }} –º¬≤</p>
                    </div>
                </div>
                
                <div class="flex justify-between items-center text-sm text-gray-600 mb-3">
                    <span>{{ apartment.object_min_floor }}-{{ apartment.object_max_floor }} —ç—Ç–∞–∂</span>
                    <span>{{ apartment.object_completion_quarter }} –∫–≤. {{ apartment.object_completion_year }}</span>
                </div>
                
                <div class="flex gap-2">
                    <a href="/zk/{{ apartment.complex_name|slug }}" 
                       class="flex-1 text-center px-3 py-2 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200 transition-colors">
                        –ñ–ö
                    </a>
                    <a href="/property/{{ apartment.inner_id }}" 
                       class="flex-1 text-center px-3 py-2 bg-[#0088CC] text-white rounded text-sm hover:bg-[#006699] transition-colors">
                        –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
        
        {% if apartments|length > 12 %}
        <div class="text-center mt-6">
            <a href="/properties?developer={{ developer.name|urlencode }}" 
               class="inline-flex items-center px-6 py-3 bg-[#0088CC] text-white rounded-lg hover:bg-[#006699] transition-colors">
                –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ {{ apartments|length }} –∫–≤–∞—Ä—Ç–∏—Ä
                <i class="fas fa-arrow-right ml-2"></i>
            </a>
        </div>
        {% endif %}
    </div>
    {% endif %}

    <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã -->
    <div class="bg-white rounded-xl shadow-sm p-6">
        <h2 class="text-xl font-bold mb-4">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
        <div class="grid md:grid-cols-2 gap-6">
            <div>
                <div class="space-y-3">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-map-marker-alt text-[#0088CC] w-5"></i>
                        <span>{{ developer.address }}</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <i class="fas fa-phone-alt text-[#0088CC] w-5"></i>
                        <a href="tel:{{ developer.phone }}" class="text-[#0088CC] hover:underline">{{ developer.phone }}</a>
                    </div>
                    {% if developer.email %}
                    <div class="flex items-center gap-3">
                        <i class="fas fa-envelope text-[#0088CC] w-5"></i>
                        <a href="mailto:{{ developer.email }}" class="text-[#0088CC] hover:underline">{{ developer.email }}</a>
                    </div>
                    {% endif %}
                    {% if developer.website %}
                    <div class="flex items-center gap-3">
                        <i class="fas fa-globe text-[#0088CC] w-5"></i>
                        <a href="https://{{ developer.website }}" target="_blank" class="text-[#0088CC] hover:underline">{{ developer.website }}</a>
                    </div>
                    {% endif %}
                </div>
            </div>
            <div>
                <div class="bg-gradient-to-r from-[#0088CC] to-[#006699] rounded-xl p-6 text-white">
                    <h3 class="font-bold text-lg mb-2">–ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é</h3>
                    <p class="text-blue-100 mb-4">–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –ø–æ–º–æ—â—å –≤ –≤—ã–±–æ—Ä–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã –∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∫—ç—à–±–µ–∫–∞</p>
                    <button onclick="openApplicationModal()" class="w-full bg-white text-[#0088CC] font-semibold py-3 px-4 rounded-lg hover:bg-blue-50 transition-all">
                        –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Search functionality
document.getElementById('complexSearch').addEventListener('input', function() {
    const searchTerm = this.value.toLowerCase();
    const complexCards = document.querySelectorAll('.complex-card');
    
    complexCards.forEach(card => {
        const name = card.getAttribute('data-name');
        const district = card.getAttribute('data-district');
        
        if (name.includes(searchTerm) || district.includes(searchTerm)) {
            card.style.display = 'block';
        } else {
            card.style.display = 'none';
        }
    });
});
</script>
{% endblock %}